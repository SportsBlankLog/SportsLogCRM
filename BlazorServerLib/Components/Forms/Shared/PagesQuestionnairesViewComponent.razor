@inherits BlazorBusyComponentBaseModel

@if (Questionnaire.Pages is null)
{
    <figure>
        <blockquote class="blockquote">
            <p>Questionnaire.Pages is null</p>
        </blockquote>
        <figcaption class="blockquote-footer">
            ошибка <cite>E112BEFB-5709-4D5A-89A5-987F19FB0371</cite>
        </figcaption>
    </figure>
}
else
{
    <MudDynamicTabs @ref="@DynamicTabs" @bind-ActivePanelIndex="@QuestionnaireIndex" AddTab="@AddTab" AddIconClass="mud-secondary-text" AddIconToolTip="Добавить страницу анкеты/опроса" CloseTab="@CloseTabCallback" CloseIconToolTip="Close tab. All data will be lost" PanelClass="px-4 py-6" Elevation="4" Rounded ApplyEffectsToContainer>
     @if (!Questionnaire.Pages.Any())
        {
            <figure class="text-center mt-3">
                <blockquote class="blockquote">
                    <p>Нет ни одной страницы</p>
                </blockquote>
                <figcaption class="blockquote-footer">
                    добавьте первую <cite>страницу</cite>
                </figcaption>
            </figure>
        }
        else
        {
            foreach (ConstructorFormQuestionnairePageModelDB questionnaire_page in Questionnaire.Pages.OrderBy(x => x.SortIndex))
            {
                questionnaire_page.Owner = Questionnaire;
                <MudTabPanel
                             ID="@questionnaire_page.Id"
                             Text="@questionnaire_page.Name"
                             Disabled="@TabIsDisabled(questionnaire_page.Id)"
                             ShowCloseIcon="@(questionnaire_page.Id < 1)"
                             BadgeDot="@(questionnaire_page.Id < 1)">
                    <CascadingValue Value="questionnaire_page">
                        <PageQuestionnaireViewComponent AllForms="AllForms" CanUpMove="@(CanUpPage(questionnaire_page))" CanDownMove="@(CanDownPage(questionnaire_page))" SetHoldHandle="SetHoldAction" UpdateQuestionnaireHandle="Update" QuestionnaireReloadHandle="QuestionnaireReloadAction" SetNameForPageHandle="SetNameForPage" SetIdForPageHandle="SetIdForPageAction" />
                    </CascadingValue>
                </MudTabPanel>
            }
        }
    </MudDynamicTabs>
}