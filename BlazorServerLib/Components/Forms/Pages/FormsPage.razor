@page "/constructor"
@attribute [Authorize]
@using BlazorWebLib.Components.Forms.Shared.Projects
@inherits BlazorBusyComponentBaseModel
@rendermode @(new InteractiveServerRenderMode(prerender: false))

<PageTitle>Конструктор</PageTitle>

<h3>
    Конструктор
    <MudTooltip>
        <ChildContent>
            <sup>
                @(MainProject is null ? "[проект не выбран]" : $"проект: '{MainProject.Name}'")
            </sup>
        </ChildContent>
        <TooltipContent>
            @if (MainProject is null)
            {
                <p>не выбран <b>текущий/основной</b> проект контекста конструктора</p>
            }
            else
            {
                <p>
                    конструктор работает в контексте основного/текущего проекта
                    @if (!string.IsNullOrWhiteSpace(MainProject.Description))
                    {
                        @((MarkupString)MainProject.Description)
                   }
                </p>
            }
        </TooltipContent>
    </MudTooltip>

</h3>
<CascadingValue Value="this">
    <MudTabs Outlined="true" Position="Position.Left" Rounded="true" Border="true" ApplyEffectsToContainer="true" Class="mt-8" PanelClass="pa-4">
        <MudTabPanel Text="Проекты">
            <ProjectsListComponent />
        </MudTabPanel>
        <MudTabPanel Disabled="@(MainProject is null)" Text="Списки">
            <DirectoryViewComponent />
        </MudTabPanel>
        <MudTabPanel Disabled="@(MainProject is null)" Text="Формы">
            <FormsViewComponent />
        </MudTabPanel>
        <MudTabPanel Disabled="@(MainProject is null)" Text="Документы">
            <QuestionnairesViewComponent />
        </MudTabPanel>
        <MudTabPanel Text="Ссылки">
            <SessionsViewComponent />
        </MudTabPanel>
    </MudTabs>
</CascadingValue>

@if (MainProject is null)
{
    <div class="alert alert-success mt-2" role="alert">
        <h4 class="alert-heading">Не выбран проект</h4>
        <hr>
        <p class="mb-0">Что бы работать с конструктором - необходимо назначить проект контекста работы</p>
    </div>
}