@using MudBlazor

@inherits BlazorBusyComponentBaseModel

@rendermode @(new InteractiveServerRenderMode(prerender: false))

<MudTreeView Style="width: 100%" ServerData="@LoadServerData" Items="@InitialTreeItems">
    <ItemTemplate Context="item">
        <MudTreeViewItem Text="@item.Text" Icon="@item.Icon" Value="item.Value" Items="item.Children" CanExpand="item.Expandable">
            <BodyContent>
                <CascadingValue Value="ReloadNodeAction">
                @if (item.Value!.Id > 0)
                {
                        <RubricNodeEditComponent @key="@($"rubric-{item.GetHashCode()}")" Item="item" />
                }
                else
                {
                        <RubricNodeCreatingNewComponent @key="@($"rubric-{item.GetHashCode()}")" ParentRubricId="item.Value.Id" />
                }
                </CascadingValue>
            </BodyContent>
        </MudTreeViewItem>
    </ItemTemplate>
</MudTreeView>