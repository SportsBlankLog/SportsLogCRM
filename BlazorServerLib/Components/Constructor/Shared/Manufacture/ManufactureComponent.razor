@inherits BlazorBusyComponentBaseModel


<div class="vstack gap-3">
    <div class="p-2"><h3>Генерация кода C#</h3></div>

    <CascadingValue Value="this">
        <div class="p-2">
            <ConfigManufactureComponent MainProject="MainProject" />
        </div>
        <div class="p-2">
            <EnumerationsManufactureComponent />
        </div>
        <div class="p-2">
            <DocumentsManufactureComponent />
        </div>
        <div class="p-2">
            <FormsManufactureComponent />
        </div>
    </CascadingValue>
</div>


@code {
    [Inject]
    IConstructorService ConstructorRepo { get; set; } = default!;

    [Inject]
    ISnackbar SnackbarRepo { get; set; } = default!;


    [Parameter, EditorRequired]
    public required MainProjectViewModel MainProject { get; set; }


    public ProjectConstructorModelDB CurrentProject { get; private set; } = default!;

    public async Task ReloadProjectData()
    {
        IsBusyProgress = true;
        ProjectConstructorModelDB? rest = await ConstructorRepo.ReadProject(MainProject.Id);
        IsBusyProgress = false;

        CurrentProject = rest ?? throw new Exception("Данные проекта не удалось получить");
    }

    protected override async Task OnInitializedAsync()
    {
        await ReloadProjectData();
    }
}