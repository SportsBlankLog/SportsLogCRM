@using MudBlazor

@inherits TTabOfDocumenBaseComponent

<MudCard>
    <MudCardContent id="@($"tab:{ID}")">
        <CascadingValue Value="this">
            @{
                int i = -1;
            }
            @foreach (FormFitModel form_metadata in TabMetadata.Forms)
            {
                i++;

                <CascadingValue Value="TabOfDocument.JoinsForms![i]">
                    <CascadingValue Value="TabMetadata">
                        <CascadingValue Value="FormsStack">
                            <CascadingValue Value="form_metadata">
                                <CascadingValue Value="SessionValues?.Where(x => x.TabJoinDocumentScheme!.Form!.Id == TabOfDocument.JoinsForms![i].Form!.Id)">
                                    <CascadingValue Value="FormChangeEvent">
                                        <CascadingValue Value="TabOfDocument">
                                            <MudPaper>
                                                @if (form_metadata.IsTable)
                                                {
                                                    <TableFormOfTabConstructorComponent DocumentKey="DocumentKey" ID="@($"[teble]{ID}>{form_metadata.SystemName}")" />
                                                }
                                                else
                                                {
                                                    <FormOfTabConstructorComponent DocumentKey="DocumentKey" ID="@($"{ID}>{form_metadata.SystemName}")" />
                                                }
                                            </MudPaper>
                                        </CascadingValue>
                                    </CascadingValue>
                                </CascadingValue>
                            </CascadingValue>
                        </CascadingValue>
                    </CascadingValue>
                </CascadingValue>
            }
        </CascadingValue>
    </MudCardContent>
</MudCard>